# ManiaMapWorkshop
作者：_IceRain

osu主页：https://osu.ppy.sh/users/7859973
![image](https://github.com/user-attachments/assets/4f39e58d-d498-4913-9aaa-0b04e3b26bb9)

———————————————————————————————————————

一个用来编辑 osu! Mania 谱面的工具集。

内置转谱器： mania-converter v0.3.0 by Siflorite

(是目前转osz后不对齐时间轴情况下最少的批量转谱方案)

内置段位计算器： DanCourse ACC Calculator v0.1.0 by _IceRain

内置6K Rating计算器：6K Rating Calculator v0.1.0 by _IceRain

———————————————————————————————————————

1. 文件加载与管理
- 支持将 .osu 文件、.osz 包、.zip 压缩包或完整文件夹直接拖拽到程序窗口加载。
- 自动识别并提取所有 .osu 谱面文件。
- 拖拽多文件、多文件夹支持，批量处理更加精准高效。
- 右侧列表视图支持多选操作，全选/取消全选，与下方功能联动。双击列表中的谱面可以直接打开谱面文件，也可右键执行打开文件、保存和移出列表操作。



2. 基本属性快捷编辑
- 修改标题（Title/Unicode）、作者（Artist/Unicode）、谱师（Creator）、版本（Version）。
- 调整谱面数值属性：HP、OD、键数（Keys）。还可以一键修改OD和HP为LN(6)/Hybrid(7)/Rice(8)
- 编辑 BeatmapID 和 BeatmapSetID，支持一键初始化。（解决“你要上传的地图不属于你”的问题）
- 重构标准化文件名，如果文件名和metadata不一致，拖入后直接保存即可重构正确文件名。（但禁用批量执行此功能，以防止造成无可挽回的后果）
- 支持设置并修改音频（Audio）、背景（Background）、视频（Video）文件名称（默认关闭，以防止误操作）。



3. 高级批量处理功能
- 物量统计：统计选中谱面每列的物量分布，Rice/Hybrid/LN分类辅助判断。

- 重叠检测：检测选中谱面点与点、点与长条、长条与长条的重叠问题。

- BPM静音：一键屏蔽选中谱面因 TimingPoints默认设置导致的多余音频变化。

- 一键恒速：对选中谱面通过生成对应倍速绿线抵消红线变速，使谱面匀速下落，达到去变速功能。

- 转反键：把选中的谱面批量转换成反键（Inverse键形）谱面。

- 去面条：把选中的谱面的面条批量全部转成点。

- 7转6-删空：批量把选中的谱面中的7K谱的第四个轨道删除，然后组成6K谱。如果选中的谱中有非7K谱则不做改动



4. 格式转换支持
- 支持将 Malody 的 .mcz 文件多选（Ctrl+点击）批量转换为 osu! 官方 .osz 包。



5. 组包器
 ![image](https://github.com/user-attachments/assets/330b8134-5ada-404a-a4d3-ba329ed0c587)

- 统一设置出包路径并打包选定谱面，生成新的文件夹或直接打包为 .osz 文件。
- 单曲组包复制原理，不影响源文件。
- 可批量自动调整 OD/HP。（根据各自谱面的LN占比）
- 可批量修改包名，且不影响 Version等其他属性。
- 支持难度框前置和后置。
- 支持自动生成对应delete upon download文件，谱面上传时请在该文件编辑界面上传。

组包器使用说明
- 1.Ctrl+点选/shift+点选：选择所有你要出包的谱面的文件夹（其中需包含谱面文件关联的完整音频文件和图片bg文件）
- 2.拖动到主界面：拖动完成后主界面右侧列表会自动抓取所有osu文件并全选
- 3.点击组包按钮：进入组包界面
- 4.点选“统一输出路径”：单曲组包功能可用。此时将你要导出的路径 拖选/输入/点击选择文件夹 来指定。否则只能用修改包名功能。
- 5.难度前置:勾选则难度前置，否则默认难度后置
- 6.生成delete upon download文件：勾选则生成，不勾选则不生成，如要上传osu官网则建议勾选。打包后该文件也会被自动指定背景图，但如果有封面个性化需求请自己指定该谱面文件的封面。
- 7.组包后自动打包成osz:勾选则打包，不勾选默认生成文件夹
- 8.输入Artist：可自己输入，也可选择下拉栏提供的两个常用选项：V.A.和Various Artists。
- 9.输入包名和作者
- 10.自动修改OD/HP：勾选则组包时会根据各自谱面的LN占比自动修改OD/HP，不勾选则不修改
- 11.点击单曲组包，就可以在指定路径生成包文件夹或者包osz了。


6. 其他特性
- Title/Artist/Creator输入框实时拦截并屏蔽非法字符：确保保存后的谱面文件名与路径都只包含合法字符，避免因文件名乱码而导致打包后无法正常导入 Malody。
- 未来将集成更多包括但不限于谱面编辑的实用工具，找工具不再烦恼：

6.1 段位acc计算支持
![image](https://github.com/user-attachments/assets/dd17da2e-758e-4efb-9bb2-f7275205fe43)

- 内置段位计算器，覆盖部分段位的单曲acc计算。

6.2 6K谱面等级计算以及6K Rating计算支持
![image](https://github.com/user-attachments/assets/6362498f-8249-478e-af05-80846c507718)

- 内置6K Rating计算器，可读取本地Songs文件夹中的所有6K谱面，也可导入/拖入任何6K谱面，进行谱面等级计算（基于xxysr）。
- 按难度搜谱功能（较慢）：点击后会把osu本地所有6K谱都算好等级，并按照等级和RC/LN分类筛选。
- 按谱师搜谱功能（较快）：点击后会把osu本地所有6K谱都读取，并按照谱师和谱包名分类筛选，且下拉栏支持输入关键词搜索。
- 在此基础上输入自己打的acc，可以得出自己在该谱中获取的Rating（类似于PP的6K等级能力数值版）。
- PS：目前xxysr算法处在早期研发阶段，对切换、高速、面条的定级较为虚高。忠告：机定不如人定，定级仅供参考。


7. 出包和谱面上传建议/注意事项
- 1.BPM线静音：除非你设计了打击音效去表现谱面，否则建议在上传前用这个功能把谱面批量处理一遍

- 2.一键恒速：除非你设计了变速效果去表现谱面，否则建议在上传前用这个功能把谱面批量处理一遍

- 3.重叠键检测：建议在上传前用这个功能把谱面批量查一遍有没有重叠键，要比一个个进aimod方便

- 4.物量统计：可以检查一下全谱面的平均“受力面积”

- 5.组包：
  
（1）组包的格式:方括号和歌曲信息之间有空格，在修改的时候最好不要把空格删掉，以保持谱面格式整洁；如果在原来的version上写[17]，则出包后难度会被标注成[[17]]。

（2）delete upon download文件: 带这个上传osu官网，可以欺骗服务器让它以为这个包需要占很大容量，把原动态上传限制锁死为最高100M/包，所以出包时建议打钩生成。但是请自己指定该文件的背景图片。

（3）ASCII字符问题：不要把文件名中带《中/日文字符和全角符号等非ASCII字符》的 osu谱面及其关联音频/背景/视频组进去，第一是本工具组不进这种谱，第二是就算组进去打包最后也会乱码。在组包前自己好好查查，去掉这些字符。

（4）Key音谱问题：带key音文件关联的谱，组包后不会把关联key音打包进去，需要自己手动把文件组进去。


- 8.mcz转osz：转好后的osu谱面文件名是一串编号，要进osu或者该工具把转出来的谱面再保存一遍，才能重构出正确文件名。建议使用本文件的保存功能重构文件名。
